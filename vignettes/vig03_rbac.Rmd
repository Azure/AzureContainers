---
title: "Authenticating with role-based access controls"
Author: Hong Ooi
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{RBAC}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{utf8}
---

The easiest way to talk to an Azure Container Registry is via its admin account, and this is what is demonstrated in the other vignettes. However, this isn't necessarily the _best_ way. There is only one admin account, which has to be shared by all users, services and resources that want to access the registry. You can't selectively enable or disable access for an individual service; nor do you have fine-grained control over what actions they can take. To solve these problems, you can use role-based access controls (RBAC) to manage which services/resources have access to the registry.

The AzureR packages make it straightforward to use RBAC to authenticate with a registry.

```r
library(AzureContainers)

az <- AzureRMR::get_azure_login()
gr <- AzureGraph::get_graph_login()

rg <- az$
    get_subscription("sub_id")$
    get_resource_group("rgname")

acr <- rg$create_acr("myregistry")

app <- gr$create_app("myappname")

acr$add_role_assignment(app, "acrpush")
```

